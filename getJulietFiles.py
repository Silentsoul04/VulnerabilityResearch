import os
import shutil

'''used to transfer juliet files over to own folders. No need to run'''

destinationPath = os.path.join('C:/', 'Wayne 2018-19', 'Thesis', 'julietSQL')

def getFileSet():
    '''grabs CWE-89 Files'''
    #get directory
    dir_path = os.path.join('C:/', 'Wayne 2018-19', 'Thesis', 'SARD-testsuite-103')

    #parse through FileSet
    fileList = []
    for root, dirs, files in os.walk(dir_path):
        for name in files:
            currentFile = os.path.join(root, name)
            if isSQLVFile(currentFile):   
                fileList.append(currentFile)
    return fileList
    #return len(fileList)

def isSQLVFile(fileDir):
    '''if "CWE_89_" in fileDir: #check for CWE 89, SQL injection
        with open(fileDir, encoding="utf8") as file:
            for i, line in enumerate(file):
                if "safe" in line:
                    return True'''
    if "CWE_89_" in fileDir:
        return True
    return False

def copyToDestination(fileList):
    for file in fileList:
        shutil.copy(file, destinationPath)

fileList = getFileSet()
copyToDestination(fileList)

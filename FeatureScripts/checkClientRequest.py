import os
import re
import fileRetriever 

def checkForSQLQuery(files):
    '''Checks for GET or POST or PUT'''
    #regex pattern
    pattern1 = re.compile("[gG][eE][tT]")
    pattern2 = re.compile("[pP][oO][sS][tT]")
    pattern3 = re.compile("[pP][uU][tT]")
    
    fileSet = []

    for fileName in files:
        with open(fileName, encoding="utf8") as file:
            #booleans to check if statements are found
            getFound = False
            postFound = False
            putFound = False

            for i, line in enumerate(file): #[(0, line), (1, line)]
                for match in re.finditer(pattern1, line):
                    getFound = True
                for match in re.finditer(pattern2, line):
                    postFound = True
                for match in re.finditer(pattern3, line):
                    putFound = True

            if getFound or postFound or putFound:
                fileAttr = [fileName, True]
                fileSet.append(fileAttr)
            else:
                fileAttr = [fileName, False]
                fileSet.append(fileAttr)
        
    print(fileSet)
        
    

if __name__ == "__main__":
    fileSet = fileRetriever.getFileSet()
    checkForSQLQuery(fileSet)

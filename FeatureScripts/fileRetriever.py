import os
from file import *

'''gets all files'''

def hasCorrectExtension(file):
    '''checks for php files'''
    if file.endswith(".php") or file.endswith(".inc") or file.endswith(".module") or file.endswith(".jsp"):
        return True
    else:
        return False

def getFileSet():
    '''grabs the file set from vulnerable and nonvulnerable folders'''
    #get current directory
    dir_path = os.path.abspath(os.curdir)
    #print(dir_path)

    #go up one directory
    os.chdir("..")
    dir_path = os.path.abspath(os.curdir)
    #print(dir_path)

    #go into FileSet directory
    dir_path = os.path.join(dir_path, "FileSet")
    #print(dir_path)

    #parse through FileSet
    fileList = []
    for root, dirs, files in os.walk(dir_path):
        for name in files:
            currentFile = os.path.join(root, name)
            if hasCorrectExtension(currentFile):
                newFile = File(currentFile, name)
                fileList.append(newFile)

    #return list of File objects
    return fileList   
